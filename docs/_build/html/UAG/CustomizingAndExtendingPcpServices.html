

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>8. Customizing and Extending PCP Services &mdash; pcp  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1. Programming Performance Co-Pilot" href="../PG/ProgrammingPcp.html" />
    <link rel="prev" title="7. Performance Co-Pilot Deployment Strategies" href="PcpDeploymentStrategies.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> pcp
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="AboutUAGGuide.html">About User’s and Administrator’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PG/AboutPGGuide.html">About Programmer’s Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">User's and Administrator's Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="IntroductionToPcp.html">1. Introduction to PCP</a></li>
<li class="toctree-l1"><a class="reference internal" href="InstallingAndConfiguringPcp.html">2. Installing and Configuring Performance Co-Pilot</a></li>
<li class="toctree-l1"><a class="reference internal" href="CommonConventionsAndArguments.html">3. Common Conventions and Arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="MonitoringSystemPerformance.html">4. Monitoring System Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="PerformanceMetricsInferenceEngine.html">5. Performance Metrics Inference Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="ArchiveLogging.html">6. Archive Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="PcpDeploymentStrategies.html">7. Performance Co-Pilot Deployment Strategies</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">8. Customizing and Extending PCP Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pmda-customization">8.1. PMDA Customization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#customizing-the-summary-pmda">8.1.1. Customizing the Summary PMDA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pcp-tool-customization">8.2. PCP Tool Customization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#archive-logging-customization">8.2.1. Archive Logging Customization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inference-engine-customization">8.2.2. ⁠Inference Engine Customization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pmns-management">8.3. PMNS Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pmns-processing-framework">8.3.1. PMNS Processing Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pmns-syntax">8.3.2. PMNS Syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pmda-development">8.4. PMDA Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pcp-tool-development">8.5. PCP Tool Development</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Programmer's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PG/ProgrammingPcp.html">1. Programming Performance Co-Pilot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PG/WritingPMDA.html">2. Writing A PMDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PG/PMAPI.html">3. PMAPI–The Performance Metrics API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PG/InstrumentingApplications.html">4. Instrumenting Applications</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pcp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>8. Customizing and Extending PCP Services</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/UAG/CustomizingAndExtendingPcpServices.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="customizing-and-extending-pcp-services">
<span id="customizingandextendingpcpservices"></span><h1>8. Customizing and Extending PCP Services<a class="headerlink" href="#customizing-and-extending-pcp-services" title="Permalink to this headline">¶</a></h1>
<p>Performance Co-Pilot (PCP) has been developed to be fully extensible. The following sections summarize the various facilities provided to allow you to extend and
customize PCP for your site:</p>
<p>Section 8.1, “<a class="reference internal" href="#pmda-customization">PMDA Customization</a>”, describes the procedure for customizing the summary PMDA to export derived metrics formed by aggregation of base PCP metrics
from one or more collector hosts.</p>
<p>Section 8.2, “<a class="reference internal" href="#pcp-tool-customization">PCP Tool Customization</a>”, describes the various options available for customizing and extending the basic PCP tools.</p>
<p>Section 8.3, “<a class="reference internal" href="#pmns-management">PMNS Management</a>”, covers the concepts and tools provided for updating the PMNS (Performance Metrics Name Space).</p>
<p>Section 8.4, “<a class="reference internal" href="#pmda-development">PMDA Development</a>”, details where to find further information to assist in the development of new PMDAs to extend the range of performance metrics available through the PCP infrastructure.</p>
<p>Section 8.5, “<a class="reference internal" href="#pcp-tool-development">PCP Tool Development</a>”, outlines how new tools may be developed to process performance data from the PCP infrastructure.</p>
<div class="section" id="pmda-customization">
<h2>8.1. PMDA Customization<a class="headerlink" href="#pmda-customization" title="Permalink to this headline">¶</a></h2>
<p>The generic procedures for installing and activating the optional PMDAs have been described in Section 2.3, “<a class="reference internal" href="InstallingAndConfiguringPcp.html#managing-optional-pmdas"><span class="std std-ref">Managing Optional PMDAs</span></a>”. In some cases, these
procedures prompt the user for information based upon the local system or network configuration, application deployment, or processing profile to customize the PMDA
and hence the performance metrics it exports.</p>
<p>The summary PMDA is a special case that warrants further discussion.</p>
<div class="section" id="customizing-the-summary-pmda">
<h3>8.1.1. Customizing the Summary PMDA<a class="headerlink" href="#customizing-the-summary-pmda" title="Permalink to this headline">¶</a></h3>
<p>The summary PMDA exports performance metrics derived from performance metrics made available by other PMDAs. It is described completely in the <strong>pmdasummary(1)</strong> man page.</p>
<p>The summary PMDA consists of two processes:</p>
<ol class="arabic">
<li><p class="first"><strong>pmie</strong> process</p>
<p>Periodically samples the base metrics and compute values for the derived metrics. This dedicated instance of the PCP <strong>pmie</strong> inference engine is launched with special
command line arguments by the main process. See Section 5.1, “<a class="reference internal" href="PerformanceMetricsInferenceEngine.html#introduction-to-pmie"><span class="std std-ref">Introduction to pmie</span></a>”, for a complete discussion of the <strong>pmie</strong> feature set.</p>
</li>
<li><p class="first"><strong>main</strong> process</p>
<p>Reads and buffers the values computed by the <strong>pmie</strong> process and makes them available to the Performance Metrics Collection Daemon (PMCD).</p>
</li>
</ol>
<p>All of the metrics exported by the summary PMDA have a singular instance and the values are instantaneous; the exported value is the correct value as of the last time
the corresponding expression was evaluated by the <strong>pmie</strong> process.</p>
<p>The summary PMDA resides in the <code class="docutils literal notranslate"><span class="pre">${PCP_PMDAS_DIR}/summary</span></code> directory and may be installed with a default configuration by following the steps described in
Section 2.3.1, “<a class="reference internal" href="InstallingAndConfiguringPcp.html#pmda-installation-on-a-pcp-collector-host"><span class="std std-ref">PMDA Installation on a PCP Collector Host</span></a>”.</p>
<p>Alternatively, you may customize the summary PMDA to export your own derived performance metrics by following the steps in <a class="reference internal" href="#procedure-8-1-customizing-the-summary-pmda">Procedure 8.1. Customizing the Summary PMDA</a>:</p>
<p id="procedure-8-1-customizing-the-summary-pmda"><strong>Procedure 8.1. Customizing the Summary PMDA</strong></p>
<ol class="arabic">
<li><p class="first">Check that the symbolic constant <strong>SYSSUMMARY</strong> is defined in the <code class="docutils literal notranslate"><span class="pre">${PCP_VAR_DIR}/pmns/stdpmid</span></code> file. If it is not, perform the postinstall update of this file, as superuser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd ${PCP_VAR_DIR}/pmns ./Make.stdpmid
</pre></div>
</div>
</li>
<li><p class="first">Choose Performance Metric Name Space (PMNS) names for the new metrics. These must begin with <strong>summary</strong> and follow the rules described in the <strong>pmns(5)</strong> man page.
For example, you might use <strong>summary.fs.cache_write</strong> and <strong>summary.fs.cache_hit</strong>.</p>
</li>
<li><p class="first">Edit the <strong>pmns</strong> file in the <code class="docutils literal notranslate"><span class="pre">${PCP_PMDAS_DIR}/summary</span></code> directory to add the new metric names in the format described in the <strong>pmns(5)</strong> man page. You must choose
a unique performance metric identifier (PMID) for each metric. In the <strong>pmns</strong> file, these appear as <strong>SYSSUMMARY:0:x</strong>. The value of x is arbitrary in the range 0
to 1023 and unique in this file. Refer to Section 8.3, “<a class="reference internal" href="#pmns-management">PMNS Management</a>”, for a further explanation of the rules governing PMNS updates.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>summary {
          cpu
          disk
          netif
          fs              /*new*/
}
summary.fs {
          cache_write     SYSSUMMARY:0:10
          cache_hit       SYSSUMMARY:0:11
}
</pre></div>
</div>
</li>
<li><p class="first">Use the local test PMNS <strong>root</strong> and validate that the PMNS changes are correct.</p>
<p>For example, enter this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pminfo</span> <span class="o">-</span><span class="n">n</span> <span class="n">root</span> <span class="o">-</span><span class="n">m</span> <span class="n">summary</span><span class="o">.</span><span class="n">fs</span>
</pre></div>
</div>
<p>You see output similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summary</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cache_write</span> <span class="n">PMID</span><span class="p">:</span> <span class="mf">27.0</span><span class="o">.</span><span class="mi">10</span>
<span class="n">summary</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">cache_hit</span> <span class="n">PMID</span><span class="p">:</span> <span class="mf">27.0</span><span class="o">.</span><span class="mi">11</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit the <code class="docutils literal notranslate"><span class="pre">${PCP_PMDAS_DIR}/summary/expr.pmie</span></code> file to add new <strong>pmie</strong> expressions. If the name to the left of the assignment operator (=) is one of the PMNS
names, then the <strong>pmie</strong> expression to the right will be evaluated and returned by the summary PMDA. The expression must return a numeric value. Additional
description of the <strong>pmie</strong> expression syntax may be found in Section 5.3, “<a class="reference internal" href="PerformanceMetricsInferenceEngine.html#specification-language-for-pmie"><span class="std std-ref">Specification Language for pmie</span></a>”.</p>
<p>For example, consider this expression:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// filesystem buffer cache hit percentages
prefix = &quot;kernel.all.io&quot;;          // macro, not exported
summary.fs.cache_write =
                100 - 100 * $prefix.bwrite / $prefix.lwrite;
summary.fs.cache_hit =
                100 - 100 * $prefix.bread / $prefix.lread;
</pre></div>
</div>
</li>
<li><p class="first">Run <strong>pmie</strong> in debug mode to verify that the expressions are being evaluated correctly, and the values make sense.</p>
<p>For example, enter this command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pmie -t 2sec -v expr.pmie
</pre></div>
</div>
<p>You see output similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>summary.fs.cache_write:      ?
summary.fs.cache_hit:      ?
summary.fs.cache_write:  45.83
summary.fs.cache_hit:   83.2
summary.fs.cache_write:  39.22
summary.fs.cache_hit:  84.51
</pre></div>
</div>
</li>
<li><p class="first">Install the new PMDA.</p>
<p>From the <code class="docutils literal notranslate"><span class="pre">${PCP_PMDAS_DIR}/summary</span></code> directory, use this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">Install</span>
</pre></div>
</div>
<p>You see the following output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Interval between summary expression evaluation (seconds)? [10] 10
Updating the Performance Metrics Name Space...
Installing pmchart view(s) ...
Terminate PMDA if already installed ...
Installing files ..
Updating the PMCD control file, and notifying PMCD ...
Wait 15 seconds for the agent to initialize ...
Check summary metrics have appeared ... 8 metrics and 8 values
</pre></div>
</div>
</li>
<li><p class="first">Check the metrics.</p>
<p>For example, enter this command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pmval -t 5sec -s 8 summary.fs.cache_write
</pre></div>
</div>
<p>You see a response similar to the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>metric:    summary.fs.cache_write
host:      localhost
semantics: instantaneous value
units:     none
samples:   8
interval:  5.00 sec
63.60132158590308
62.71878646441073
62.71878646441073
58.73968492123031
58.73968492123031
65.33822758259046
65.33822758259046
72.6099706744868
</pre></div>
</div>
<p>Note that the values are being sampled here by <strong>pmval</strong> every 5 seconds, but <strong>pmie</strong> is passing only new values to the summary PMDA every 10 seconds. Both rates
could be changed to suit the dynamics of your new metrics.</p>
</li>
<li><p class="first">You may now create <strong>pmchart</strong> views, <strong>pmie</strong> rules, and <strong>pmlogger</strong> configurations to monitor and archive your new performance metrics.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="pcp-tool-customization">
<h2>8.2. PCP Tool Customization<a class="headerlink" href="#pcp-tool-customization" title="Permalink to this headline">¶</a></h2>
<p>Performance Co-Pilot (PCP) has been designed and implemented with a philosophy that embraces the notion of toolkits and encourages extensibility.</p>
<p>In most cases, the PCP tools provide orthogonal services, based on external configuration files. It is the creation of new and modified configuration files that
enables PCP users to customize tools quickly and meet the needs of the local environment, in many cases allowing personal preferences to be established for individual
users on the same PCP monitor system.</p>
<p>The material in this section is intended to act as a checklist of pointers to detailed documentation found elsewhere in this guide, in the man pages, and in the
files that are made available as part of the PCP installation.</p>
<div class="section" id="archive-logging-customization">
<h3>8.2.1. Archive Logging Customization<a class="headerlink" href="#archive-logging-customization" title="Permalink to this headline">¶</a></h3>
<p>The PCP archive logger is presented in Chapter 6, <a class="reference internal" href="ArchiveLogging.html#archive-logging"><span class="std std-ref">Archive Logging</span></a>, and documented in the <strong>pmlogger(1)</strong> man page.</p>
<p>The following global files and directories influence the behavior of <strong>pmlogger</strong>:</p>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_SYSCONF_DIR}/pmlogger</span></code></p>
<p>Enable/disable state for the primary logger facility using this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chkconfig</span> <span class="n">pmlogger</span> <span class="n">on</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_SYSCONF_DIR}/pmlogger/config.default</span></code></p>
<p>The default <strong>pmlogger</strong> configuration file that is used for the primary logger when this facility is enabled.</p>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_VAR_DIR}/config/pmlogconf/tools</span></code></p>
<p>Every PCP tool with a fixed group of performance metrics contributes a <strong>pmlogconf</strong> configuration file that includes each of the performance metrics used in the tool,
for example, <code class="docutils literal notranslate"><span class="pre">${PCP_VAR_DIR}/config/pmlogconf/pmstat</span></code> for <strong>pmstat</strong>.</p>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_PMLOGGERCONTROL_PATH}</span></code> or <code class="docutils literal notranslate"><span class="pre">${PCP_PMLOGGERCONTROL_PATH}.d</span></code> files</p>
<p>Defines which PCP collector hosts require <strong>pmlogger</strong> to be launched on the local host, where the configuration file comes from, where the archive log files should
be created, and <strong>pmlogger</strong> startup options.</p>
<p>These <strong>control</strong> files support the starting and stopping of multiple <strong>pmlogger</strong> instances that monitor local or remote hosts.</p>
<p><code class="docutils literal notranslate"><span class="pre">/etc/cron.d/pcp-pmlogger</span></code> or <code class="docutils literal notranslate"><span class="pre">${PCP_VAR_DIR}/config/pmlogger/crontab</span></code></p>
<p>Default <strong>crontab</strong> entries that may be merged with the <strong>crontab</strong> entries for the <strong>pcp</strong> user to schedule the periodic execution of the archive log management scripts,
for example, <strong>pmlogger_daily</strong>.</p>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_LOG_DIR}/pmlogger/somehost</span></code></p>
<p>The default behavior of the archive log management scripts create archive log files for the host <em>somehost</em> in this directory.</p>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_LOG_DIR}/pmlogger/somehost/Latest</span></code></p>
<p>A PCP archive folio for the most recent archive for the host <em>somehost</em>. This folio is created and maintained by the <strong>cron</strong>-driven periodic archive log management
scripts, for example, <strong>pmlogger_check</strong>. Archive folios may be processed with the <strong>pmafm</strong> tool.</p>
</div>
<div class="section" id="inference-engine-customization">
<h3>8.2.2. ⁠Inference Engine Customization<a class="headerlink" href="#inference-engine-customization" title="Permalink to this headline">¶</a></h3>
<p>The PCP inference engine is presented in Chapter 5, <a class="reference internal" href="PerformanceMetricsInferenceEngine.html#performance-metrics-inference-engine"><span class="std std-ref">Performance Metrics Inference Engine</span></a>, and documented in the <strong>pmie(1)</strong> man page.</p>
<p>The following global files and directories influence the behavior of <strong>pmie</strong>:</p>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_SYSCONF_DIR}/pmie</span></code></p>
<p>Controls the pmie daemon facility. Enable using this command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>chkconfig pmie on
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_SYSCONF_DIR}/pmie/config.default</span></code></p>
<p>The <strong>pmie</strong> configuration file that is used for monitoring the local host when the <strong>pmie</strong> daemon facility is enabled in the default configuration.
This file is created using <strong>pmieconf</strong> the first time the daemon facility is activated.</p>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_PMIECONTROL_PATH}</span></code> and <code class="docutils literal notranslate"><span class="pre">${PCP_PMIECONTROL_PATH}.d</span></code> files</p>
<p>Defines which PCP collector hosts require a daemon <strong>pmie</strong> to be monitoring from the local host, where the configuration files comes from, where the <strong>pmie</strong>
log file should be created, and <strong>pmie</strong> startup options.</p>
<p>These <strong>control</strong> files support the starting and stopping of multiple <strong>pmie</strong> instances that are each monitoring one or more hosts.</p>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_VAR_DIR}/config/pmieconf/*/*</span></code></p>
<p>Each <strong>pmieconf</strong> rule definition can be found below one of these subdirectories.</p>
<p><code class="docutils literal notranslate"><span class="pre">/etc/cron.d/pcp-pmie</span></code> or <code class="docutils literal notranslate"><span class="pre">${PCP_VAR_DIR}/config/pmie/crontab</span></code></p>
<p>Default <strong>crontab</strong> entries that may be merged with the <strong>crontab</strong> entries for the <strong>pcp</strong> user to schedule the periodic execution of the <strong>pmie_check</strong> and <strong>pmie_daily</strong>
scripts, for verifying that <strong>pmie</strong> instances are running and logs rotated.</p>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_LOG_DIR}/pmie/somehost</span></code></p>
<p>The default behavior of the <code class="docutils literal notranslate"><span class="pre">${PCP_RC_DIR}/pmie</span></code> startup scripts create <strong>pmie</strong> log files for the host <em>somehost</em> in this directory.</p>
<p><code class="docutils literal notranslate"><span class="pre">pmie_check</span></code> and <code class="docutils literal notranslate"><span class="pre">pmie_daily</span></code></p>
<p>These commands are similar to the <strong>pmlogger</strong> support scripts, <strong>pmlogger_check</strong> and <strong>pmlogger_daily</strong>.</p>
<p><code class="docutils literal notranslate"><span class="pre">${PCP_TMP_DIR}/pmie</span></code></p>
<p>The statistics that <strong>pmie</strong> gathers are maintained in binary data structure files. These files can be found in the <code class="docutils literal notranslate"><span class="pre">${PCP_TMP_DIR}/pmie</span></code> directory.</p>
<p><strong>pmcd.pmie</strong> metrics</p>
<p>The PMCD PMDA exports information about executing <strong>pmie</strong> processes and their progress in terms of rule evaluations and action execution rates.</p>
<p>If <strong>pmie</strong> is running on a system with a PCP collector deployment, the <strong>pmcd</strong> PMDA exports these metrics via the <strong>pmcd.pmie</strong> group of metrics.</p>
</div>
</div>
<div class="section" id="pmns-management">
<h2>8.3. PMNS Management<a class="headerlink" href="#pmns-management" title="Permalink to this headline">¶</a></h2>
<p>This section describes the syntax, semantics, and processing framework for the external specification of a Performance Metrics Name Space (PMNS) as it might be
loaded by the PMAPI routine <strong>pmLoadNameSpace</strong>; see the <strong>pmLoadNameSpace(3)</strong> man page. This is usually done only by <strong>pmcd</strong>, except in rare circumstances such as
Section 8.1.1, “<a class="reference internal" href="#customizing-the-summary-pmda">Customizing the Summary PMDA</a>”.</p>
<p>The PMNS specification is a simple text source file that can be edited easily. For reasons of efficiency, a binary format is also supported; the utility <strong>pmnscomp</strong>
translates the ASCII source format into binary format; see the <strong>pmnscomp(1)</strong> man page.</p>
<div class="section" id="pmns-processing-framework">
<h3>8.3.1. PMNS Processing Framework<a class="headerlink" href="#pmns-processing-framework" title="Permalink to this headline">¶</a></h3>
<p>The PMNS specification is initially passed through <strong>pmcpp(1)</strong>. This means the following facilities may be used in the specification:</p>
<ul class="simple">
<li>C-style comments</li>
<li><strong>#include</strong> directives</li>
<li><strong>#define</strong> directives and macro substitution</li>
<li>Conditional processing with <strong>#ifdef, #ifndef, #endif</strong>, and <strong>#undef</strong></li>
</ul>
<p>When <strong>pmcpp(1)</strong> is executed, the standard include directories are the current directory and <code class="docutils literal notranslate"><span class="pre">${PCP_VAR_DIR}/pmns</span></code>, where some standard macros and default
specifications may be found.</p>
</div>
<div class="section" id="pmns-syntax">
<h3>8.3.2. PMNS Syntax<a class="headerlink" href="#pmns-syntax" title="Permalink to this headline">¶</a></h3>
<p>Every PMNS is tree structured. The paths to the leaf nodes are the performance metric names. The general syntax for a non-leaf node in PMNS is as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pathname {
        name    [pmid]
        ...
}
</pre></div>
</div>
<p>Here <strong>pathname</strong> is the full pathname from the root of the PMNS to this non-leaf node, with each component in the path separated by a period. The root node for the
PMNS has the special name <strong>root</strong>, but the prefix string <strong>root</strong>. must be omitted from all other <strong>pathnames</strong>.</p>
<p>For example, refer to the PMNS shown in <a class="reference internal" href="#figure-8-1-small-performance-metrics-name-space-pmns">Figure 8.1. Small Performance Metrics Name Space (PMNS)</a>. The correct pathname for the rightmost non-leaf node is
<strong>cpu.utilization</strong>, not <strong>root.cpu.utilization</strong>.</p>
<div class="figure" id="id1">
<span id="figure-8-1-small-performance-metrics-name-space-pmns"></span><img alt="../_images/pmns-small2.png" src="../_images/pmns-small2.png" />
<p class="caption"><span class="caption-text">Figure 8.1. Small Performance Metrics Name Space (PMNS)</span></p>
</div>
<p>Each component in the pathname must begin with an alphabetic character and be followed by zero or more alphanumeric characters or the underscore (_) character.
For alphabetic characters in a component, uppercase and lowercase are significant.</p>
<p>Non-leaf nodes in the PMNS may be defined in any order desired. The descendent nodes are defined by the set of <strong>names</strong>, relative to the pathname of their parent
non-leaf node. For descendent nodes, leaf nodes have a <strong>pmid</strong> specification, but non-leaf nodes do not.</p>
<p>The syntax for the <strong>pmid</strong> specification was chosen to help manage the allocation of Performance Metric IDs (PMIDs) across disjoint and autonomous domains of
administration and implementation. Each <strong>pmid</strong> consists of three integers separated by colons, for example, <strong>14:27:11</strong>. This is intended to mirror the
implementation hierarchy of performance metrics. The first integer identifies the domain in which the performance metric lies. Within a domain, related metrics are
often grouped into clusters. The second integer identifies the cluster, and the third integer, the metric within the cluster.</p>
<p>The PMNS specification for <a class="reference internal" href="#figure-8-1-small-performance-metrics-name-space-pmns">Figure 8.1. Small Performance Metrics Name Space (PMNS)</a> is shown in <a class="reference internal" href="#example-8-1-pmns-specification">Example 8.1. PMNS Specification</a>:</p>
<p id="example-8-1-pmns-specification">Example 8.1. PMNS Specification</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/*
* PMNS Specification
*/
#define KERNEL 1
root {
       network
       cpu
}
#define NETWORK 26
network {
       interrupts    KERNEL:NETWORK:1
       packets
}
network.packets {
       in     KERNEL:NETWORK:35
       out    KERNEL:NETWORK:36
}
#define CPU 10
cpu {
       syscalls    KERNEL:CPU:10
       utilization
}
#define USER 20
#define SYSTEM 21
#define IDLE 22
cpu.utilization {
       user    KERNEL:CPU:USER
       sys     KERNEL:CPU:SYSTEM
       idle    KERNEL:CPU:IDLE
}
</pre></div>
</div>
<p>For complete documentation of the PMNS and associated utilities, see the <strong>pmns(5), pmnsadd(1), pmnsdel(1)</strong> and <strong>pmnsmerge(1)</strong> man pages.</p>
</div>
</div>
<div class="section" id="pmda-development">
<h2>8.4. PMDA Development<a class="headerlink" href="#pmda-development" title="Permalink to this headline">¶</a></h2>
<p>Performance Co-Pilot (PCP) is designed to be extensible at the collector site.</p>
<p>Application developers are encouraged to create new PMDAs to export performance metrics from the applications and service layers that are particularly relevant to
a specific site, application suite, or processing environment.</p>
<p>These PMDAs use the routines of the <strong>libpcp_pmda</strong> library, which is discussed in detail in the <em>Performance Co-Pilot Programmer’s Guide</em>.</p>
</div>
<div class="section" id="pcp-tool-development">
<h2>8.5. PCP Tool Development<a class="headerlink" href="#pcp-tool-development" title="Permalink to this headline">¶</a></h2>
<p>Performance Co-Pilot (PCP) is designed to be extensible at the monitor site.</p>
<p>Application developers are encouraged to create new PCP client applications to monitor or display performance metrics in a manner that is particularly relevant to
a specific site, application suite, or processing environment.</p>
<p>Client applications use the routines of the PMAPI (performance metrics application programming interface) described in the <em>Performance Co-Pilot Programmer’s Guide</em>.
At the time of writing, native PMAPI interfaces are available for the C, C++ and Python languages.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../PG/ProgrammingPcp.html" class="btn btn-neutral float-right" title="1. Programming Performance Co-Pilot" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="PcpDeploymentStrategies.html" class="btn btn-neutral float-left" title="7. Performance Co-Pilot Deployment Strategies" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Performance Co-Pilot

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>